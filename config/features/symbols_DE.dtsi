/*
*
* Copyright (c) 2022 Rafael Rom√£o
* SPDX-License-Identifier: MIT
*
*/

/ {
    symbols {
        // Base

        SHIFT_MORPH(mm_semi,          &kp DE_SEMI, &kp DE_COLON)
        MACRO(mc_end_semi,            &kp END &kp DE_SEMI)
        TAPHOLD_TP(th_semi,           &mm_semi, &mc_end_semi)

        MACRO(mc_end_semi_ent,        &kp END &kp DE_SEMI &kp ENTER)

        MACRO(mc_h,                   &kp DE_H)
        TAPHOLD_TP(th_hyper_h,        &mc_h, &mc_hyper)

        MACRO(mc_comma,               &kp DE_COMMA)
        MACRO(mc_end_comma,           &kp END &kp DE_COMMA )
        TAPHOLD_TP(th_comma,          &mc_comma, &mc_end_comma)

        MACRO(mc_dot,                 &kp DE_DOT )
        MACRO(mc_end_dot,             &kp END &kp DE_DOT )
        TAPHOLD_TP(th_dot,            &mm_dot_meh, &mc_end_dot)

        // Numbers

        SHIFT_MEH(mc_n0,              &kp DE_N0, &kp KP_N0)
        SHIFT_MEH(mc_n1,              &kp DE_N1, &kp KP_N1)
        SHIFT_MEH(mc_n2,              &kp DE_N2, &kp KP_N2)
        SHIFT_MEH(mc_n3,              &kp DE_N3, &kp KP_N3)
        SHIFT_MEH(mc_n4,              &kp DE_N4, &kp KP_N4)
        SHIFT_MEH(mc_n5,              &kp DE_N5, &kp KP_N5)
        SHIFT_MEH(mc_n6,              &kp DE_N6, &kp KP_N6)
        SHIFT_MEH(mc_n7,              &kp DE_N7, &kp KP_N7)
        SHIFT_MEH(mc_n8,              &kp DE_N8, &kp KP_N8)
        SHIFT_MEH(mc_n9,              &kp DE_N9, &kp KP_N9)

        LAYERTAP_TP(lt_n0,            &mc_n0)

        MACRO(mc_sqo,                 &kp DE_SQT &kp DE_SPACE)
        MACRO(mc_end_sqo,             &kp END &mc_sqo)
        TAPHOLD_TP(th_sqo,            &mc_sqo, &mc_end_sqo)

        MACRO(mc_dqo,                 &kp DE_DQT &kp DE_SPACE)
        MACRO(mc_end_dqo,             &kp END &mc_dqo)
        TAPHOLD_TP(th_dqo,            &mc_dqo, &mc_end_dqo)

        MACRO(mc_bti,                 &kp DE_GRAVE &kp DE_SPACE)
        MACRO(mc_end_bti,             &kp END &mc_bti)
        TAPHOLD_TP(th_bti,            &mc_bti, &mc_end_bti)

        MACRO(mc_and,                 &kp DE_AMPS &kp DE_AMPS)
        MACRO(mc_right_and,           &kp RIGHT &kp DE_AMPS &kp DE_AMPS)
        TAPHOLD_TP(th_and,            &mc_and, &mc_right_and)

        MACRO(mc_or,                  &kp DE_PIPE &kp DE_PIPE)
        MACRO(mc_right_or,            &kp RIGHT &kp DE_PIPE &kp DE_PIPE)
        TAPHOLD_TP(th_or,             &mc_or, &mc_right_or)

        MACRO(mc_rpar,                &kp DE_RPAR)
        MACRO(mc_end_rpar,            &kp END &kp DE_RPAR)
        TAPHOLD_TP(th_rpar,           &mc_rpar, &mc_end_rpar)

        MACRO(mc_lpar,                &kp DE_LPAR)
        MACRO(mc_end_lpar,            &kp END &kp DE_LPAR)
        TAPHOLD_TP(th_lpar,           &mc_lpar, &mc_end_lpar)

        MACRO(mc_rbkt,                &kp DE_RBKT)
        MACRO(mc_end_rbkt,            &kp END &kp DE_RBKT)
        TAPHOLD_TP(th_rbkt,           &mc_rbkt, &mc_end_rbkt)

        MACRO(mc_lbkt,                &kp DE_LBKT)
        MACRO(mc_end_lbkt,            &kp END &kp DE_LBKT)
        TAPHOLD_TP(th_lbkt,           &mc_lbkt, &mc_end_lbkt)

        MACRO(mc_rbrc,                &kp DE_RBRC)
        MACRO(mc_end_rbrc,            &kp END &kp DE_RBRC)
        TAPHOLD_TP(th_rbrc,           &mc_rbrc, &mc_end_rbrc)

        MACRO(mc_lbrc,                &kp DE_LBRC)
        MACRO(mc_end_lbrc,            &kp END &kp DE_LBRC)
        TAPHOLD_TP(th_lbrc,           &mc_lbrc, &mc_end_lbrc)

        MACRO(mc_pars,                &kp DE_LPAR &kp DE_RPAR)
        MACRO(mc_end_pars,            &kp END &kp DE_LPAR &kp DE_RPAR)
        TAPHOLD_TP(th_pars,           &mc_pars, &mc_end_pars)

        MACRO(mc_brackets,            &kp DE_LBKT &kp DE_RBKT)
        LAYERTAP_TP(lt_brackets,      &mc_brackets)

        MACRO(mc_deg,                 &kp DE_DEG)
        LAYERTAP_TP(lt_deg,           &mc_deg)

        // Symbols

        MACRO(mc_us,                  &kp LS(DE_U) &kp LS(DE_S) &kp DE_DOLLAR)
        MACRO(mc_usd,                 &kp LS(DE_U) &kp LS(DE_S) &kp LS(DE_D))
        TAPHOLD_TP(th_us,             &mc_us, &mc_usd)
        MACRO(mc_br,                  &kp LS(DE_R) &kp DE_DOLLAR)
        MACRO(mc_brl,                 &kp LS(DE_B) &kp LS(DE_R) &kp LS(DE_L))
        TAPHOLD_TP(th_br,             &mc_br, &mc_brl)
        MACRO(mc_euro,                &kp DE_EURO)
        MACRO(mc_eur,                 &kp LS(DE_E) &kp LS(DE_U) &kp LS(DE_R))
        TAPHOLD_TP(th_eur,            &mc_euro, &mc_eur)

        MACRO(mc_pars_semi_ent,       &kp END &kp DE_LPAR &kp DE_RPAR &kp DE_SEMI &kp ENTER)

        MACRO(mc_tdqo,                &mc_dqo &mc_dqo &mc_dqo)
        MACRO(mc_tdqo_ent,            &mc_tdqo &kp ENTER)
        TAPHOLD_TP(th_tdqo,           &mc_tdqo, &mc_tdqo_ent)

        MACRO(mc_tbti,                &mc_bti &mc_bti &mc_bti)
        MACRO(mc_tbti_ent,            &mc_tbti &kp ENTER)
        TAPHOLD_TP(th_tbti,           &mc_tbti, &mc_tbti_ent)

        MACRO(mc_braces_new,          &kp END &kp DE_LBRC &kp ENTER)

        MACRO(mc_sarrow,              &kp DE_MINUS &kp DE_GT)
        MACRO(mc_end_sarrow,          &kp END &kp DE_MINUS &kp DE_GT)
        TAPHOLD_TP(th_sarrow,         &mc_sarrow, &mc_end_sarrow)

        MACRO(mc_darrow,              &kp DE_EQUAL &kp DE_GT)
        MACRO(mc_end_darrow,          &kp END &kp DE_EQUAL &kp DE_GT)
        TAPHOLD_TP(th_darrow,         &mc_darrow, &mc_end_darrow)

        MACRO(mc_forward,             &kp DE_PIPE &kp DE_GT)
        MACRO(mc_end_forward,         &kp END &kp ENTER &kp DE_PIPE &kp DE_GT)
        TAPHOLD_TP(th_forward,        &mc_forward, &mc_end_forward)

        MACRO(mc_backward,            &kp DE_LT &kp DE_MINUS)
        MACRO(mc_end_backward,        &kp END &kp ENTER &kp DE_PIPE &kp DE_GT)
        TAPHOLD_TP(th_backward,       &mc_backward, &mc_end_backward)

        MACRO(mc_concat,              &kp DE_LT &kp DE_GT)
        MACRO(mc_end_concat,          &kp END &kp DE_LT &kp DE_GT)
        TAPHOLD_TP(th_concat,         &mc_concat, &mc_end_concat)

        MACRO(mc_dcurly,              &kp DE_DOLLAR &kp DE_LBRC)
        MACRO(mc_hcurly,              &kp DE_HASH &kp DE_LBRC)
        MACRO(mc_pcurly,              &kp DE_PERCENT &kp DE_LBRC)
        MACRO(mc_dcolon,              &kp DE_COLON &kp DE_COLON)

        MACRO(mc_end_dcolon,          &kp END &kp DE_COLON &kp DE_COLON)
        TAPHOLD_TP(th_dcolon,         &mc_dcolon, &mc_end_dcolon)

        MACRO(mc_perc,                &kp DE_PERCENT)
        MACRO(mc_end_perc,            &kp END &kp DE_PERCENT)
        TAPHOLD_TP(th_perc,           &mc_perc, &mc_end_perc)

        MACRO(mc_lt,                  &kp DE_LT)
        MACRO(mc_gt,                  &kp DE_GT)

        MACRO(mc_qmark,               &kp DE_QMARK )
        MACRO(mc_end_qmark,           &kp END &mc_qmark )
        TAPHOLD_TP(th_qmark,          &mc_qmark, &mc_end_qmark)

        MACRO(mc_eqeq,                &kp DE_EQUAL &kp DE_EQUAL)
        MACRO(mc_end_eqeq,            &kp END &kp DE_EQUAL &kp DE_EQUAL)
        TAPHOLD_TP(th_eqeq,           &mc_eqeq, &mc_end_eqeq)

        MACRO(mc_noteq,               &kp DE_EXCL &kp DE_EQUAL)
        MACRO(mc_end_noteq,           &kp END &kp DE_EXCL &kp DE_EQUAL)
        TAPHOLD_TP(th_noteq,          &mc_noteq, &mc_end_noteq)

        MACRO(mc_tisl,                &kp DE_TILDE &kp DE_SPACE &kp DE_SLASH)
        MACRO(mc_ds,                  &kp DE_DOT &kp DE_SLASH)
        MACRO(mc_dds,                 &kp DE_DOT &kp DE_DOT &kp DE_SLASH)

        MACRO(mc_ord_o,               &kp LA(N0)) // Check what LA(N0) maps to
        MACRO(mc_ord_a,               &kp LA(N9)) // Check what LA(N9) maps to
        TAPHOLD_TP(th_ord_o,          &mc_ord_o, &mc_meh)
        TAPHOLD_TP(th_ord_a,          &mc_ord_a, &mc_hyper)

        MACRO(mc_qr,                  &kp DE_Q &kp DE_R)
        MACRO(mc_atr,                 &kp DE_AT &kp DE_R)
        MACRO(mc_atat,                &kp DE_AT &kp DE_AT)

        // Macros

        MACRO(mc_exit,  &kp DE_E &kp DE_X &kp DE_I &kp DE_T &kp ENTER)
        MACRO(mc_haha,  &kp DE_H &kp DE_A &kp DE_H &kp DE_A &kp ENTER)
        MACRO(mc_hugs,  &kp DE_LBKT &kp DE_RBKT &kp DE_SQT &kp DE_S)
        MACRO(mc_otask, &kp DE_MINUS &kp DE_SPACE &kp DE_LBKT &kp DE_SPACE &kp DE_RBKT &kp DE_SPACE)
        MACRO(mc_oref,  &kp DE_LBKT &kp DE_LBKT)
        MACRO(mc_end_do_ent, &kp END &kp DE_D &kp O &kp ENTER)


        // Mehs

        MACRO(mc_sl_vim_replace       , &sl VIM_REPLACE)
        LAYERTAP_TP(msl_a1cp          , &mc_sl_vim_replace)

        // Vim

        MACRO(mc_end_colon,           &kp END &kp DE_COLON)

        MACRO(mc_end_excl,            &kp END &kp DE_EXCL)
        TAPHOLD_TP(th_excl,           &lm_excl_vim, &mc_end_excl)

        MACRO(mc_end_eql,             &kp END &kp DE_EQUAL)
        TAPHOLD_TP(th_eql,            &lm_eql_vim, &mc_end_eql)

        MACRO(mc_tilde,               &lm_tilde_vim &kp DE_SPACE)
        LAYERTAP_TP(lt_tilde,         &mc_tilde)

        MACRO(mm_shift_vim_replace    , &mm_shift &ntsl VIM_REPLACE)
        LAYERTAP_TP(ht_sft_vim        , &mm_shift_vim_replace)

        MACRO(mc_spc_esc,         &kp DE_I &macro_press &kp DE_SPACE &macro_pause_for_release &macro_release &kp DE_SPACE &macro_tap &kp ESC)
        MACRO(mc_dqt0p,           &kp DE_DQT &kp DE_SPACE &kp DE_N0 &kp DE_P)
        MACRO(mc_dqt1p,           &kp DE_DQT &kp DE_SPACE &kp DE_N1 &kp DE_P)
        MACRO(mc_dqtplusp,        &kp DE_DQT &kp DE_SPACE &kp DE_PLUS &kp DE_P)
        MACRO(mc_dqtplusy,        &kp DE_DQT &kp DE_SPACE &kp DE_PLUS &kp DE_Y)
        MACRO(mc_colpercsslash,   &kp DE_COLON &kp DE_PERCENT &kp DE_S &kp DE_SLASH &to ALPHA1)
        MACRO(mc_at_at,           &kp DE_AT &kp DE_AT)

        mc_caret: mc_caret {
            compatible = "zmk,behavior-macro";
            #binding-cells = <0>;
            wait-ms = <0>;
            tap-ms = <0>;
            bindings = <&macro_tap &kp CARET &kp SPACE>;
        };

        mc_zero: mc_zero {
            compatible = "zmk,behavior-macro";
            #binding-cells = <0>;
            wait-ms = <0>;
            tap-ms = <0>;
            bindings = <&macro_tap &kp N0>;
        };

        vim_home: vim_home {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&mc_caret>;

            ADAPTIVE(caret_zero, &mc_zero, SPACE)
        };

        TAPHOLD_TP(th_caret_z, &vim_home, &mc_zero)

        MACRO(mc_o_esc,         &macro_tap &kp DE_O &kp ESC)
        MACRO(mc_sft_o_esc,     &macro_tap &kp LS(DE_O) &kp ESC)

        LAYERTAP_TP(lt_lead_vim       , &vim_space_lead)
        TAPHOLD_TP(th_colon_vim       , &lm_colon_vim, &mc_end_colon)
        MACRO(mc_end_enter_vim        , &kp END &lm_ent_vim)
        MACRO(mc_save_esc_vim         , &mc_save &lm_esc_vim)

        MACRO(mc_o_vim,  &vim_o_ctrl_o &kp F24) // reset antecedent key for magic keys
        MACRO(mc_a_vim,  &vim_a_ctrl_a &kp F24) // reset antecedent key for magic keys
        MACRO(mc_i_vim,  &vim_i_ctrl_i &kp F24) // reset antecedent key for magic keys
        MACRO(mc_c_vim,  &lm_c_vim)
        MACRO(mc_ca_vim, &vim_ca       &kp F24) // reset antecedent key for magic keys
        MACRO(mc_ci_vim, &vim_ci       &kp F24) // reset antecedent key for magic keys
        MACRO(mc_ce_vim, &kp DE_E      &kp F24) // reset antecedent key for magic keys

        MODTAP_TP(mt_i_vim, &mc_i_vim)
        MODTAP_TP(mt_c_vim, &mc_c_vim)
        MODTAP_TP(mt_s_vim, &vim_s_alt_s)
        MODTAP_TP(mt_r_vim, &vim_r_ctrl_r)

        LAYERTAP_TP(lt_q_vim       , &lm_q_vim)
        LAYERTAP_TP(lt_a_vim       , &mc_a_vim)
    };
};
